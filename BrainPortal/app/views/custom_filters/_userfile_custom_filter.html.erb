
<%-
#
# CBRAIN Project
#
# Copyright (C) 2008-2012
# The Royal Institution for the Advancement of Learning
# McGill University
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.  
#
-%>

<% custom_filter ||= @custom_filter %>
<p>
   Filename:<br>
   
       <%= select :data, :file_name_type, [["Don't filter name", ''], ['Matches', 'match'], ['Contains', 'contain'], ['Begins with', 'begin'], ['Ends with', 'end']], :selected => custom_filter.data["file_name_type"]    %>
       <%= text_field_tag "data[file_name_term]", custom_filter.data["file_name_term"] %>
     
</p>
<p>
   File format:<br>
   
      <%= select :data, :type, Userfile.descendants.sort_by(&:name).map{ |u| [u.pretty_type, u.name] }, :include_blank  => true, :selected  => custom_filter.data["type"]  %>
   
</p>
   Filtering by date: <br/> 
   <%= render :partial => 'shared/date_range', :locals  => {:date_attribute            => ['data[date_attribute]',            custom_filter[:data]["date_attribute"]], 
                                                            :absolute_or_relative_from => ['data[absolute_or_relative_from]', custom_filter[:data]['absolute_or_relative_from']],
                                                            :absolute_or_relative_to   => ['data[absolute_or_relative_to]',   custom_filter[:data]['absolute_or_relative_to']],
                                                            :relative_from             => ['data[relative_from]',             custom_filter[:data]['relative_from']],
                                                            :relative_to               => ['data[relative_to]',               custom_filter[:data]['relative_to']],
                                                            :absolute_from             => ['data[absolute_from]',             custom_filter[:data]['absolute_from']],
                                                            :absolute_to               => ['data[absolute_to]',               custom_filter[:data]['absolute_to']]
                                                           }
  %>
</p>
<p>
   Size:<br>
   
       <%= select :data, :size_type, [["Don't filter size", ''], ['=', "0"], ['<', "1"], ['>', "2"]], :selected  => custom_filter.data["size_type"] %>
       <%= text_field_tag "data[size_term]", custom_filter.data["size_term"] %> kb
   
</p>

<p>
   Owner:<br>

      <%= user_select("data[user_id]", { :selector => custom_filter.data["user_id"] }, { :include_blank => true })  %>
</p>

<p>
   Project:<br>
 
       <%= group_select("data[group_id]", { :selector => custom_filter.data["group_id"]}, { :include_blank => true })  %>
 
</p>

<p>
    Data Provider:<br>

       <%= data_provider_select("data[data_provider_id]", { :selector => custom_filter.data["data_provider_id"] || '!' }, { :include_blank => true })  %>

</p> 

<% unless current_user.available_tags.blank? %>
      <p>
         Tags:
         
            <table>
              <% for tag in current_user.available_tags %>
                  <tr class="<%= cycle('list-odd', 'list-even') %>">
                    <td><%= check_box_tag("custom_filter[tag_ids][]", tag.id.to_s, custom_filter.tag_ids.include?(tag.id.to_s)) %></td>
                    <td><%= tag.name -%></td>
                  </tr>
              <% end %>
            </table>
         
      </p>
<% end %>
   
