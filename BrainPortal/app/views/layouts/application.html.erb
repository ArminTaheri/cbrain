<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">
<%

#
# CBRAIN Project
#
# Main web site layout
#
# Original author: Pierre Rioux
#
# $Id$
#

-%>


<html>

   <head>
       <title>CBRAIN Project <%= yield :title %></title>
       <%= stylesheet_link_tag "cbrain", :media => "all" %>
       <%= javascript_include_tag :defaults %>
   </head>

   <body id="cbrain">
      <div id="main-content">
         <div id="wrapper">
         
            <div id="top-menu">
            
               <div id="account">
                  <ul>
                    <li>
                       <% if current_user %>
                             <a href="/logout">Sign out</a>
                         <% else %>
                             <a href="/login">Sign in</a>
                       <% end %>
                    </li>
                  </ul>
               </div> <!-- End id="account" -->
  
               <% if current_user %>
                 <div id="loggedas">Logged in as <%=h current_user.full_name %></div>
                <% end %>
         
               <ul>
                 <% if current_user %>
                   <li><%= link_to 'My Account', current_user %></li>
                 <% end %>
                 <li><a class="credits" href="/">Credits</a></li>
               </ul>
            
            </div>  <!-- End id="top-menu" -->
         
            <div id="header">
              <h1>CBrain <%= CBRAIN::Redmine_Version %></h1>
              <div id="top_01"><div>
                 <div id="main-menu">
                    <% if current_user %>
                       <ul>      
                          <li <%= set_selected(params[:controller], :portal) %>><a class="home" href="/home">Home</a></li>
                          <li <%= set_selected(params[:controller], :userfiles) %>><%= link_to 'Files', userfiles_path, :id => 'files_top_menu' %></li>
                          <li <%= set_selected(params[:controller], :tasks) %>><%= link_to 'Tasks', :controller => :tasks, :action => :index %></li>
                          <li <%= set_selected(params[:controller], :data_providers) %>><%= link_to 'Data Providers', data_providers_path %></li>
                          <li <%= set_selected(params[:controller], :bourreaux) %>><%= link_to 'Bourreaux', bourreaux_path %></li>               
                          <li <%= set_selected(params[:controller], :feedbacks) %>><%= link_to 'Feedback', feedbacks_path %></li>
                          <% if current_user && (current_user.has_role?(:admin) || current_user.has_role?(:site_manager))%>
                            <li <%= set_selected(params[:controller], :users) %>><%= link_to 'Users', users_path %></li>
                            <li <%= set_selected(params[:controller], :groups) %>><%= link_to 'Groups', groups_path %></li>
                     		 <% if current_user.has_role?(:admin) %>
                    			    <li <%= set_selected(params[:controller], :sites) %>><%= link_to 'Sites', sites_path %></li> 	
                    	          <li <%= set_selected(params[:controller], :logged_exception) %>><%= link_to 'Logged Exceptions', :controller  => :logged_exceptions, :action  => :index %></li>
                    			 <% end %>
                          <% end %>
                          <% if current_user.site %>
         	  					<li <%= set_selected(params[:controller], :user_site_show) %>><%= link_to "#{current_user.site.name} Info", site_path(current_user.site) %></li> 	
         	  				  <% end %>
                       </ul>
                    <% end %>               
                 </div>  <!-- End id="main-menu" -->
              
              </div>  <!-- End id="top_01" -->
           
            </div>   <!-- End id="header" -->   
         
         </div>  <!-- End id="wrapper" -->  


         <div id = "main">
            
        
            <div id="content">
               <% if ! flash[:notice].nil? && ! flash[:notice].empty? %>
                 <p class = "notice" id="flash_notice"><%= h(flash[:notice]).gsub(/\n/,"<BR>") -%></p>  
               <% end %>
               <% if ! flash[:error].nil? && ! flash[:error].empty? %>
                  <p class="error" id="flash_error"><%= h(flash[:error]).gsub(/\n/,"<BR>") -%></p>
               <% end %>
               <%= yield :layout %>
            </div>   <!-- End id="content" -->
         </div>  <!-- End id="main" -->

         <div id="footer">
           <div id = "topfooter">
              <div id="leftfoot">
              </div>   <!-- End id="leftfoot" -->
              <div id = "rightfoot">
              </div>  <!-- End id="rightfoot" -->
           </div>   <!-- End id="topfooter" -->
           <div id="bottomfooter">
              <p>
                  Montreal Neurological Institute<br>
                  3801 University Street, Montreal, Quebec, Canada H3A 2B4<br>
                  Copyright Â©
              </p>
           </div> <!-- End id="bottomfooter" -->
         </div> <!-- End id="footer" -->
      </div> <!-- End id="main-content" -->
   </body>
</html>
