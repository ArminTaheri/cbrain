<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">
<%

#
# CBRAIN Project
#
# Main web site layout
#
# Original author: Pierre Rioux
#
# $Id$
#

-%>


<html>

   <head>
       <title>CBRAIN Project <%= yield :title %></title>
       <link rel="shortcut icon" href="/images/favicon.gif" />
       <%= stylesheet_link_tag "cbrain", "niftyCorners", :media => "all" %>
       <%= javascript_include_tag :defaults %>
       <%= javascript_include_tag "tableH" %>
       <%= javascript_include_tag "niftycube" %>
   </head>

   <body id="cbrain">
      <div id="main-content">
         <div id="wrapper">
         
            <div id="top-menu">
            
               <div id="account">
                  <ul>
                    <li>
                       <% if current_user %>
                             <a href="/logout">Sign out</a>
                         <% else %>
                             <a href="/login">Sign in</a>
                       <% end %>
                    </li>
                  </ul>
               </div> <!-- End id="account" -->
  
               <% if current_user %>
                 <div id="loggedas">Logged in as <%=h current_user.full_name %></div>
                <% end %>
         
               <ul>
                 <% if current_user %>
                   <li><%= link_to 'My Account', current_user %></li>
                 <% end %>
                 <li><a class="credits" href="/">Credits</a></li>
               </ul>
            
            </div>  <!-- End id="top-menu" -->
         
            <div id="header">
              <h1>CBRAIN <%= CBRAIN::Redmine_Version %></h1>
              <div id="top_01"><div>
                 <div id="main-menu">
                    <% if current_user %>
                       <ul>      
                          <li <%= set_selected(params[:controller], :portal) %>><a class="home" href="/home">Home</a></li>
                          <li <%= set_selected(params[:controller], :userfiles) %>><%= link_to 'Files', userfiles_path, :id => 'files_top_menu' %></li>
                          <li <%= set_selected(params[:controller], :tasks) %>><%= link_to 'Tasks', :controller => :tasks, :action => :index %></li>
                          <li <%= set_selected(params[:controller], :data_providers) %>><%= link_to 'Data Providers', data_providers_path %></li>
                          <li <%= set_selected(params[:controller], :bourreaux) %>><%= link_to 'Execution Servers', bourreaux_path %></li>               
                          <li <%= set_selected(params[:controller], :feedbacks) %>><%= link_to 'Feedback', feedbacks_path %></li>
                          <li <%= set_selected(params[:controller], :messages) %>><%= link_to 'Messages', messages_path, :title  => pluralize(@unread_message_count, "unread message"), :id  => "message_menu_tab" %></li>
                          <% if current_user && (current_user.has_role?(:admin) || current_user.has_role?(:site_manager))%>
                            <li <%= set_selected(params[:controller], :users) %>><%= link_to 'Users', users_path %></li>
                            <li <%= set_selected(params[:controller], :groups) %>><%= link_to 'Groups', groups_path %></li>
                     		 <% if current_user.has_role?(:admin) %>
                    			    <li <%= set_selected(params[:controller], :sites) %>><%= link_to 'Sites', sites_path %></li> 	
                    	        <li <%= set_selected(params[:controller], :logged_exception) %>><%= link_to 'Logged Exceptions', :controller  => :logged_exceptions, :action  => :index %></li>
                    			 <% end %>
                          <% end %>
                          <% if current_user.site %>
         	  					<li <%= set_selected(params[:controller], :user_site_show) %>><%= link_to "#{current_user.site.name} Info", site_path(current_user.site) %></li> 	
         	  				  <% end %>
                       </ul>
                    <% end %>               
                 </div>  <!-- End id="main-menu" -->
              
              </div>  <!-- End id="top_01" -->
           
            </div>   <!-- End id="header" -->   
         
         </div>  <!-- End id="wrapper" -->  


         <div id = "main">
            
        
            <div id="content">
              <div id="message_display">
                <%= render :partial => 'layouts/message_display' %>
              </div>
              <%= yield :layout %>
            </div>   <!-- End id="content" -->
         </div>  <!-- End id="main" -->

         <div id="footer">
           <div id = "topfooter">
              
           </div>   <!-- End id="topfooter" -->
           <div id="bottomfooter">
               <a href="http://www.canarie.ca/">
                 <img id="canarie_logo" src="/images/CANARIE_h.jpg" />
               </a>
               <img id="site_logos" src="/images/site_logos.png" usemap="#logomap"/>     
               <map id="logomap" name="logomap">
                 <area shape="rect" 
                 coords="0,0,75,100" 
                 alt="McGill"
                 href="http://www.bic.mni.mcgill.ca/~alan/">
                 <area shape="rect" 
                 coords="75,0,150,100" 
                 alt="Rotman"
                 href="http://www.rotman-baycrest.on.ca/index.php?section=217">
                 <area shape="rect" 
                 coords="150,0,225,100" 
                 alt="UdeM"
                 href="http://www.criugm.qc.ca/a_chercheur.html?id=9">
                 <area shape="rect" 
                 coords="225,0,300,100" 
                 alt="UBC"
                 href="http://www.neuroscience.ubc.ca/stoessl.htm">
                 <area shape="rect" 
                 coords="300,0,375,100" 
                 alt="Robarts"
                 href="http://www.imaging.robarts.ca/Faculty/menon.html"> 
               </map>           
           </div> <!-- End id="bottomfooter" -->
         </div> <!-- End id="footer" -->
      </div> <!-- End id="main-content" -->
   </body>
</html>
