<%

#
# CBRAIN Project
#
# File manager main layout
#
# Original author: Pierre Rioux
#
# $Id: index.html.erb 38 2008-10-31 17:13:03Z prioux $
#

-%>

<% title 'Files' %>

<h1>Welcome. These are your files:</h1>
<% form_tag userfiles_path, {:method => :get} do %>
   <%= text_field_tag :search_term, params[:search_term] %>
   <%= hidden_field_tag :search_type, :name_search %>
   <%= submit_tag "Search", :name => nil %>
<% end %>
<%= link_to 'All Files', userfiles_path %>
<%= link_to 'MINC Files', userfiles_path(:search_type => :minc) %>
<%= link_to 'JIV Files', userfiles_path(:search_type => :jiv) %>

<% form_tag(operation_userfiles_path, :method => :post) do %>

<table>
   <tr>
       <th>Select</th>
       <th>Filename</th>
       <th>Size</th>
   </tr>
   <% for userfile in @userfiles %>
       <tr class="<%= cycle('list-odd', 'list-even') %>">
         <td><%= check_box_tag("filelist[]", userfile.id.to_s) %></td>
         <td>
            <%= '&nbsp' * 4 * userfile.level + '&#x21b3;' if userfile.level > 0 -%>
            <%= link_to h(userfile.name), userfile %>
         </td>
         <td><%= h(userfile.size) -%></td>
       </tr>
   <% end %>
</table>

Operations: <%= select_tag(
   "operation", 
    '
    <option value="">Select an operation</option>

    <optgroup label="Scientific operations">
    <option value="minc2jiv">Convert selected MINC files to JIV</option>

    <optgroup label="Management operations">
    <option value="delete">Delete selected files</option>
    '
   ) %>

<%= submit_tag("Apply Operation") %>

<% end %>

<h3>Add a new file:</h3>

<%
   form_tag( "/userfiles", :multipart => true, :method => :post ) do
%>
      <%= file_field_tag("upload_file") %>
      <%= submit_tag("Upload file")     %>
<% end %>
