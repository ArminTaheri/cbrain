<h2>
  QC Tagging for: <%= @userfile.name %>
</h2>
(Dataset <%= @current_index + 1 %> out of <%= @filelist.size %>)
<br><br>
<% form_tag :action  => :quality_control do %>
  <%= submit_tag "Pass" %> <%= submit_tag "Fail" %> <%= submit_tag "Unknown" %> <%= submit_tag "Skip" %><br><br>
  <% @filelist.each do |id| %>
    <%= hidden_field_tag "file_ids[]", id %>
  <% end %>
  <%= hidden_field_tag :index, @current_index %>
  <select name="tag_ids[]" multiple="multiple" style="width:150px" >
  <%= options_from_collection_for_select current_user.tags, 'id', 'name', @userfile.get_tags_for_user(current_user).map(&:id) %>
  </select>
  <br>
  <%= submit_tag "Update Tags" %>
<% end %>

<br>
<% if @userfile.respond_to?(:qc_files) && !@userfile.qc_files.blank? %>
  <% if @userfile.is_locally_synced? %>
    <% @userfile.qc_files.map(&:name).each do |qc| %>
      <%= image_tag url_for(:action  => :content, :id  => @userfile.id, :collection_file  => qc) %><br>
    <% end %>
  <% else %>
    This file must be synced locally to view QC data.
  <% end %>
<% else %>
  File <% @userfile.name %> does not contain QC data.
<% end %>

