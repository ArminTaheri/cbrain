<% if eval("@#{model_name}").errors.empty? %>
  <%= render :partial  => "shared/flash_update" %>
  jQuery('#<%= model_name %>_table').append(jQuery("<%= escape_javascript(render :partial => "#{model_name.pluralize}/#{model_name}_table_row", :locals  => eval("{:#{model_name}  => @#{model_name}}")) %>"));
  jQuery("#errorExplanation").remove();
  jQuery(".fieldWithErrors").removeClass("fieldWithErrors");
  jQuery('#new_<%= model_name %>_button').click();
<% else %>
    jQuery('#new_<%= model_name %>').html("<%= escape_javascript(render :partial  => "#{model_name.pluralize}/new") %>");
<% end %>

  