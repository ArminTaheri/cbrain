
<% title 'Access Summary' %>

<% if @view == 'by_bourreau' %>
  <h1>Tool Access Report, By Execution Server</h1>
  <% @bourreaux.each do |bourreau| %>
    <p>
    <%= render :partial => 'by_bourreau',
               :locals  => { :bourreau => bourreau,
                             :users    => @users,
                             :tools    => @tools,
                            }
    %>
  <% end %>
<% elsif @view == 'by_tool' %>
  <h1>Tool Access Report, By Tool</h1>
  <% @tools.each do |tool| %>
    <p>
    <%= render :partial => 'by_tool',
               :locals  => { :bourreaux => @bourreaux,
                             :users     => @users,
                             :tool      => tool,
                            }
    %>
  <% end %>
<% elsif @view == 'by_user' %>
  <h1>Tool Access Report, By User</h1>
  <% @users.each do |user| %>
    <p>
    <%= render :partial => 'by_user',
               :locals  => { :bourreaux => @bourreaux,
                             :user      => user,
                             :tools     => @tools,
                            }
    %>
  <% end %>
<% end %>

<p>

<h1>Quick Links To Individual Access Reports</h1>

<h5>By Execution Server (or <%= link_to "all of them", :action => :index %>)</h5>
<% array_to_table(Bourreau.all.sort { |a,b| a.name <=> b.name }, :table_class => 'simple', :rows => 1 ) do |bourreau,r,c| %>
  <%= link_to bourreau.name, :action => :index, :bourreau_id => bourreau.id %>
<% end %>

<p>

<h5>By Tool (or <%= link_to "all of them", :action => :index, :view => 'by_tool' %>)</h5>
<% array_to_table(Tool.all.sort { |a,b| a.name <=> b.name }, :table_class => 'simple', :td_class => 'no_wrap' ) do |tool,r,c| %>
  <%= link_to tool.name, :action => :index, :tool_id => tool.id %>
<% end %>

<p>

<h5>By User (or <%= link_to "all of them", :action => :index, :view => 'by_user' %>)</h5>
<% array_to_table(User.all.sort { |a,b| a.login <=> b.login }, :table_class => 'simple' ) do |user,r,c| %>
  <%= link_to user.login, :action => :index, :user_id => user.id %>
<% end %>

