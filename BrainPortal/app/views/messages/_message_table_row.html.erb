<tr class=" message_display_<%= mess.id %> <%= "#{cycle("list-odd", "list-even")} row_highlight" if mess.read? %>">

  <td class="<%= "#{mess.message_type}_display " unless mess.read? %>left_side wrap">
    <%= check_box_tag("message_ids[]", mess.id.to_s, false) %>&nbsp;
    <%= 
      link_to_function Message.parse_markup( h(mess.header) ) do |page|
        page["message_table_details_#{mess.id}"].toggle
      end 
    %>
    <div id="message_table_details_<%= mess.id %>" class="no_wrap" style="display:none">
      <%= render :partial  => 'layouts/message_details', :locals  => {:mess  => mess} %>
    </div>
  </td>

  <td class="<%= "#{mess.message_type}_display " unless mess.read? %>middle">
    <%= to_localtime(mess.last_sent, :datetime) %>
  </td>

  <td class="<%= "#{mess.message_type}_display " unless mess.read? %>right_side">

    <% if mess.read %>
      <%= 
        link_to  'Mark&nbsp;as&nbsp;Unread',  message_path(mess, :read => "false"),
                 :class => 'delete_button action_link', 
                 "data-method"  => "PUT",
                 "data-delete-selector"  => ".message_display_#{mess.id}", 
                 "data-delete-text"  => "<td colspan='3' style='color:red; text-align:center;'>Updating...</td>"
      %>
    <% else %>
      <%= 
        link_to  'Mark&nbsp;as&nbsp;Read',  message_path(mess, :read  => "true"),
                 :class => 'delete_button action_link', 
                 "data-method"  => "PUT",
                 "data-delete-selector"  => ".message_display_#{mess.id}", 
                 "data-delete-text"  => "<td colspan='3' style='color:red; text-align:center;'>Updating...</td>"
      %>
    <% end %>
    &nbsp;
    <%= 
       link_to  'Delete',  message_path(mess),
                :class => 'delete_button action_link', 
                "data-method"  => "DELETE",
                "data-delete-selector"  => ".message_display_#{mess.id}", 
                "data-delete-text"  => "<td colspan='3' style='color:red; text-align:center;'>Deleting...</td>"
    %>
  </td>

</tr>

