
<% if @message.errors.empty? %>

try{
  jQuery("#new_message_button").click();
  jQuery("#new_message").find("form").resetForm();
  var new_display = jQuery(<%= html_for_js(render :partial  => 'messages/message_display') %>);
  var new_table = jQuery(<%= html_for_js(render :partial  => 'message_table') %>);
  jQuery("#message_display").html(new_display);
  jQuery("#message_table").html(new_table);
  new_display.trigger("new_content");
  new_table.trigger("new_content");
} catch (error) {  
  alert(error.message);  
}

<% else %>
  jQuery('#new_message').html(<%= html_for_js(render :partial  => "new") %>);
<% end %>

