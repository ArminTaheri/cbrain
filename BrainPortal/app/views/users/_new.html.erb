
<%= error_messages_for :user %>

<%= ajax_form_for @user, :as => :user, :url => { :action => "create" }, :datatype => "script" do |f| -%>

  <div class="display_cell">
    <p><%= f.label :full_name, "Full Name" %><br/>
    <%= f.text_field :full_name %></p>
  
    <p><%= f.label :login, "Login" %><br/>
    <%= f.text_field :login %><br>
    <small>For <strong>Tom Jones</strong>, use <strong>tjones</strong>, not 'tom' or 'jones'.</small>
    </p>
  
    <p><%= f.label :email, "Email" %><br/>
    <%= f.text_field :email %></p>
    
    <p>
      <%= f.label :city, "City" %><br/>
      <%= f.text_field :city %>
    </p>
    
    <p>
      <%= f.label :country, "Country" %><br/>
      <%= f.text_field :country %>
    </p>
    
    <p><%= f.label :time_zone, "Time Zone" %><br/>
    <%= f.time_zone_select :time_zone,
        ActiveSupport::TimeZone.all.select { |t| t.name =~ /canada/i },
        { :default => ActiveSupport::TimeZone['Eastern Time (US & Canada)'],
          :include_blank => true }
    %></p>
    
    <p><%= f.label :role, "Role" %><br/>
    <%= f.select :role, roles_for_user(current_user) %> </p>
    
    <% if current_user.has_role? :admin %>
      <p><%= f.label :site_id, "Site" %><br/>
      <%= f.collection_select :site_id, Site.all, :id, :name, {:include_blank  => true} %></p>
    <% end %>
    
    <p><%= f.label :password, "Password" %><br/>
    <%= f.password_field :password %></p>
  
    <p><%= f.label :password_confirmation, "Confirm Password" %><br/>
    <%= f.password_field :password_confirmation %></p>

    <p><label for="no_pwd_reset">No need to reset initial password:</label>
    <%= check_box_tag :no_password_reset_needed, "1", params[:no_password_reset_needed] == "1" %>
    
    <p><%= submit_tag 'Create User' %></p>
  </div>
  
  <div class="display_cell">
    <%= render :partial => 'group_tables' %>
  </div>
  
<% end %>

