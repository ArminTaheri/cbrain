
<tr class="<%= cycle('list-odd', 'list-even') %> row_highlight" id="user_<%= user.id %>">
  <td class="left"><%= h(user.full_name) %></td>
  <td><%= link_to_user_if_accessible(user) %></td>
  <td><%=h user.email %></td>
  <% groups = user.groups.reject{|g| g.name == 'everyone' || g.name == user.login }.sort{|a, b| a.name.casecmp(b.name)} %>
  <td><%= groups.map{|g| work_group_link g, h(g.name), group_path(g)}.join('<BR>') %></td>
  <td><%=h user.role.humanize %></td>
  <td><%= link_to_site_if_accessible(user.site) %></td>
  <td><%= h user.city %></td>
  <td><%= h user.country %></td>
  <td><%= h(user.time_zone || "(Unset)") %></td>
  <td><%=h user.userfiles.count %></td>
  <% unless user.login == 'admin' %>
    <td>
      <%= 
           delete_button 'Delete', user_path(user), :class  => "action_link", 
                                                    :confirm  => 'Are you sure?', 
                                                    :target  => "#user_#{user.id}",
                                                    :target_text  => "<td colspan='11' style='color:red; text-align:center'>Deleting...</td>"
      %>
    </td>
    <td><%= link_to 'Switch', switch_user_path(user), :class => 'action_link', :method  => :post %></td>
  <% else %>
    <td colspan="2"></td>
  <% end %>
</tr>

